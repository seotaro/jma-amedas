(this["webpackJsonpjma-amedas"]=this["webpackJsonpjma-amedas"]||[]).push([[0],{157:function(e,n){},200:function(e,n,t){},207:function(e,n){},212:function(e,n,t){"use strict";t.r(n);var a=t(1),i=t.n(a),r=t(33),o=t.n(r),c=t(151),l=(t(200),t(69)),u=t.n(l),s=t(105),p=t(89),d=t(261),m=t(265),h=t(258),f=t(263),j=t(257),b=t(176),w=Object(b.a)({palette:{primary:{main:"#111111",background:"#eeeeee",opacity:.8},secondary:{main:"#eeeeee"}},typography:{fontFamily:["Noto Sans","sans-serif"].join(","),h1:{fontSize:24,fontWeight:"600"},body1:{fontSize:16,fontWeight:"300"}}}),x=t(251),g=t(256),O=t(260),v=t(270),y=t(174),k=t(268),S=t(271),V=t(180),z=t(181),M=t(179),C=t(264),F=t(43),P=t(152),D=t.n(P),E=t(127),A=t.n(E),T="https://www.jma.go.jp/bosai/amedas/const/amedastable.json",G="https://www.jma.go.jp/bosai/amedas/data/latest_time.txt",I=function(e){return"https://www.jma.go.jp/bosai/amedas/data/map/".concat(A()(e).format("YYYYMMDDHHmmss"),".json")},J=function(e,n,t){return null===e?null:(e-n)/(t-n)},N=function(e,n,t){return null===e?null:n*(1-e)+t*e};function Y(e,n,t){360<=e&&(e=0);var a=Math.floor(e/60)%6,i=e/60-a,r=t*(1-n),o=t*(1-n*i),c=t*(1-n*(1-i)),l=[0,0,0];switch(a){case 0:l=[t,c,r];break;case 1:l=[o,t,r];break;case 2:l=[r,t,c];break;case 3:l=[r,o,t];break;case 4:l=[c,r,t];break;case 5:l=[t,r,o]}return l.map((function(e){return Math.floor(255*e)}))}function L(){return R.apply(this,arguments)}function R(){return(R=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D()(G).then((function(e){return e.text()})).then((function(e){return new Date(e)})).catch((function(e){console.error(e)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e){return _.apply(this,arguments)}function _(){return(_=Object(s.a)(u.a.mark((function e(n){var t,a,i,r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[T,I(n)],e.next=3,Promise.all(t.map((function(e){return D()(e).then((function(e){return e.text()})).then((function(e){return JSON.parse(e)})).catch((function(e){console.error(e)}))})));case 3:return a=e.sent,i=Object(p.a)(a,2),r=i[0],o=i[1],e.abrupt("return",Object.keys(o).map((function(e){var n=r[e],t=o[e];return{code:e,name:n.kjName,coordinates:[n.lon[0]+n.lon[1]/60,n.lat[0]+n.lat[1]/60],precipitation10m:t.precipitation10m&&0===t.precipitation10m[1]?t.precipitation10m[0]:null,precipitation1h:t.precipitation1h&&0===t.precipitation1h[1]?t.precipitation1h[0]:null,precipitation3h:t.precipitation3h&&0===t.precipitation3h[1]?t.precipitation3h[0]:null,precipitation24h:t.precipitation24h&&0===t.precipitation24h[1]?t.precipitation24h[0]:null,wind:t.wind&&t.windDirection&&0===t.wind[1]&&0===t.windDirection[1]?[t.wind[0],360*t.windDirection[0]/16]:null,temp:t.temp&&0===t.temp[1]?t.temp[0]:null,sun1h:t.sun1h&&0===t.sun1h[1]?t.sun1h[0]:null,snow:t.snow&&0===t.snow[1]?t.snow[0]:null,snow6h:t.snow6h&&0===t.snow6h[1]?t.snow6h[0]:null,snow12h:t.snow12h&&0===t.snow12h[1]?t.snow12h[0]:null,snow24h:t.snow24h&&0===t.snow24h[1]?t.snow24h[0]:null,humidity:t.humidity&&0===t.humidity[1]?t.humidity[0]:null}})));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B=t(28),H={longitude:136,latitude:35,zoom:5,maxZoom:20,pitch:45,bearing:0},U={precipitation10m:{name:"10\u5206\u9593\u964d\u6c34\u91cf",min:0,max:40,colormap:function(e){return Y(N(e,240,0),1,1)}},precipitation1h:{name:"1\u6642\u9593\u964d\u6c34\u91cf",min:0,max:80,colormap:function(e){return Y(N(e,240,0),1,1)}},precipitation3h:{name:"3\u6642\u9593\u964d\u6c34\u91cf",min:0,max:150,colormap:function(e){return Y(N(e,240,0),1,1)}},precipitation24h:{name:"24\u6642\u9593\u964d\u6c34\u91cf",min:0,max:300,colormap:function(e){return Y(N(e,240,0),1,1)}},wind:{name:"\u98a8\u5411\u30fb\u98a8\u901f",min:0,max:25,colormap:function(e){return Y(N(e,240,0),1,1)}},temp:{name:"\u6c17\u6e29",min:-10,max:30,colormap:function(e){return Y(N(e,240,0),1,1)}},sun1h:{name:"\u65e5\u7167\u6642\u9593",min:0,max:1,colormap:function(e){return Y(N(e,240,0),1,1)}},snow:{name:"\u7a4d\u96ea\u6df1",min:0,max:200,colormap:function(e){return Y(N(e,240,0),1,1)}},snow6h:{name:"6\u6642\u9593\u964d\u96ea\u91cf",min:0,max:50,colormap:function(e){return Y(N(e,240,0),1,1)}},snow12h:{name:"12\u6642\u9593\u964d\u96ea\u91cf",min:0,max:70,colormap:function(e){return Y(N(e,240,0),1,1)}},snow24h:{name:"24\u6642\u9593\u964d\u96ea\u91cf",min:0,max:100,colormap:function(e){return Y(N(e,240,0),1,1)}},humidity:{name:"\u6e7f\u5ea6",min:0,max:100,colormap:function(e){return Y(N(e,240,0),1,1)}}},q=Object(x.a)((function(){return{title:{position:"absolute",top:10,left:10,zIndex:10,padding:10,background:w.palette.primary.background,opacity:w.palette.primary.opacity}}}));var Z=function(){var e=q(),n=Object(a.useState)("temp"),t=Object(p.a)(n,2),i=t[0],r=t[1],o=Object(a.useState)("gridcell"),c=Object(p.a)(o,2),l=c[0],b=c[1],x=Object(a.useState)(null),P=Object(p.a)(x,2),D=P[0],E=P[1],T=Object(a.useState)(null),G=Object(p.a)(T,2),I=G[0],N=G[1],Y=Object(a.useState)(null),R=Object(p.a)(Y,2),_=R[0],Z=R[1],K=new URLSearchParams(Object(F.d)().search).get("viewType")||"MapView";Object(a.useEffect)((function(){Object(s.a)(u.a.mark((function e(){var n,t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:return n=e.sent,e.next=5,W(n);case 5:t=e.sent,N(t),E(n);case 8:case"end":return e.stop()}}),e)})))()}),[]),Object(a.useEffect)((function(){switch(i){case"wind":"icon"!==l&&b("icon");break;default:"icon"===l&&b("gridcell")}}),[i]),Object(a.useEffect)((function(){Object(s.a)(u.a.mark((function e(){var n,t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I){e.next=2;break}return e.abrupt("return");case 2:n=2500,t=function(e){if("wind"===e){var t=I.map((function(n){var t=n[e]?[J(n[e][0],U[e].min,U[e].max),n[e][1]]:null;return{code:n.code,name:n.name,coordinates:n.coordinates,normlizedValue:t,value:n[e],color:null===t?[0,0,0,32]:U[e].colormap(t[0]),icon:null===t||0==t[1]?"dot":"arrow",angle:null===t?0:180-t[1]}}));return Object(B.jsx)(k.a,{id:"iconlayer",data:t,pickable:!0,iconAtlas:"wind-icon.png",iconMapping:"wind-icon.json",getIcon:function(e){return e.icon},getColor:function(e){return e.color},getPosition:function(e){return e.coordinates},billboard:!1,sizeUnits:"meters",sizeScale:10,getSize:function(e){return n},getAngle:function(e){return e.angle}})}var a=I.map((function(n){var t=J(n[e],U[e].min,U[e].max);return{code:n.code,name:n.name,coordinates:n.coordinates,normlizedValue:t,value:n[e],color:null===t?[0,0,0,32]:U[e].colormap(t)}}));switch(l){case"gridcell":return Object(B.jsx)(S.a,{id:"gridcelllayer",data:a,pickable:!0,cellSize:5e3,extruded:!0,elevationScale:5e4,getPosition:function(e){return e.coordinates},getFillColor:function(e){return e.color},getElevation:function(e){return e.normlizedValue}});case"column":return Object(B.jsx)(V.a,{id:"columnlayer",data:a,pickable:!0,diskResolution:20,radius:n,extruded:!0,elevationScale:5e4,getPosition:function(e){return e.coordinates},getFillColor:function(e){return e.color},getElevation:function(e){return e.normlizedValue}});case"scatterplot":return Object(B.jsx)(z.a,{id:"scatterplotlayer",data:a,pickable:!0,opacity:.8,filled:!0,radiusScale:n,lineWidthMinPixels:1,getPosition:function(e){return e.coordinates},getRadius:function(e){return e.normlizedValue},getFillColor:function(e){return e.color}})}}(i),Z(t);case 5:case"end":return e.stop()}}),e)})))()}),[I,i,l]);var Q=Object.keys(U).map((function(e){return Object(B.jsx)(m.a,{value:e,children:U[e].name},e)})),X={gridcell:{disabled:"wind"===i},column:{disabled:"wind"===i},scatterplot:{disabled:"wind"===i},icon:{disabled:"wind"!==i}},$=Object.keys(X).map((function(e){return Object(B.jsx)(m.a,{value:e,disabled:X[e].disabled,children:e},e)}));return Object(B.jsxs)(a.Fragment,{children:[Object(B.jsx)(g.a,{theme:w,children:Object(B.jsxs)(f.a,{className:e.title,children:[Object(B.jsx)(j.a,{variant:"h1",color:"primary",children:"JMA AMeDAS"}),Object(B.jsx)(f.a,{p:.5,children:Object(B.jsx)(j.a,{variant:"body1",color:"primary",children:A()(D).format()})}),Object(B.jsx)(f.a,{p:.5,children:Object(B.jsx)(h.a,{children:Object(B.jsx)(d.a,{value:i,onChange:function(e){return r(e.target.value)},children:Q})})}),Object(B.jsx)(f.a,{p:.5,children:Object(B.jsx)(h.a,{children:Object(B.jsx)(d.a,{value:l,onChange:function(e){return b(e.target.value)},children:$})})}),Object(B.jsx)(f.a,{p:.5,children:Object(B.jsx)(h.a,{children:Object(B.jsx)(d.a,{value:K,onChange:function(e){window.location.href="?viewType=".concat(e.target.value)},children:[Object(B.jsx)(m.a,{value:"MapView",children:"MapView"},"MapView"),Object(B.jsx)(m.a,{value:"GlobeView",children:"GlobeView"},"GlobeView")]})})})]})}),Object(B.jsxs)(O.a,{initialViewState:H,controller:!0,getTooltip:function(e){var n=e.object;return n&&"".concat(n.name,"\uff08").concat(n.code,"\uff09: ").concat(n.value)},children:[Object(B.jsx)(M.a,{id:"background-layer",data:[[[-180,90],[0,90],[180,90],[180,-90],[0,-90],[-180,-90]]],getPolygon:function(e){return e},filled:!0,getFillColor:[127,127,127]}),Object(B.jsx)(C.a,{id:"map-layer",data:"https://d2ad6b4ur7yvpq.cloudfront.net/naturalearth-3.3.0/ne_50m_land.geojson",filled:!0,getFillColor:[64,64,64]}),_,"GlobeView"===K?Object(B.jsx)(v.a,{id:"map",width:"100%",controller:!0,resolution:1}):Object(B.jsx)(y.a,{id:"map",width:"100%",controller:!0,repeat:!0})]})]})},K=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,273)).then((function(n){var t=n.getCLS,a=n.getFID,i=n.getFCP,r=n.getLCP,o=n.getTTFB;t(e),a(e),i(e),r(e),o(e)}))};o.a.render(Object(B.jsx)(i.a.StrictMode,{children:Object(B.jsx)(c.a,{children:Object(B.jsx)(Z,{})})}),document.getElementById("root")),K()}},[[212,1,2]]]);